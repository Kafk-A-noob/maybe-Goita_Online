# May be ごいた Online (Ver 0.85 Preview)

## 謝辞

本ゲームは能登地方の伝統文化「ごいた」を題材にしています。 伝統を保存・継承してこられた保存会の皆様に敬意を表します。

## 概要

これは、能登地方に伝わる伝統的な対戦型テーブルゲーム「ごいた」を Web ブラウザで手軽に遊べるように実装したものです。
シングルプレイ（1 人 vs 3CPU）とマルチプレイ（オンライン対戦）の両方に対応しています。
また、素人が思いつきで作成したものであるため、コードレビューやプレイレビューの際はお手柔らかにお願いいたします。

> [!NOTE] > **Ver 0.85 Preview について**
> 現在のバージョンはプレリリース（プレビュー）版です。
> 特に新しく実装された**「五し」ルール（手動宣言・配り直し判定）**については十分な検証が行われていません。
> 予期せぬ挙動が発生する可能性がありますが、開発中であることをご理解いただけますと幸いです。

---

## ゲームをプレイする

以下の URL からすぐにプレイできます。特別なインストールは不要です。

[ゲームをプレイ](https://maybe-goita-online.vercel.app/)

### 遊び方

#### シングルプレイ

- **1 人 vs 3CPU** で対戦します。
- あなたは常に「チーム A」のプレイヤーとなり、対面の CPU とペアを組みます。
- 手軽にルールを覚えたり、練習するのに最適です。

#### マルチプレイ

- **オンラインで他のプレイヤーと対戦** できます。
- **部屋を作成**: 好きな名前を入力して部屋を作ると、4 文字の「あいことば」が発行されます。
- **部屋に参加**: 友達から教えてもらった「あいことば」を入力して部屋に参加します。
- **人数不足**: 4 人揃わない場合は、空き枠に自動的に CPU が補充されます。
- **ホスト機能**: 部屋を作ったプレイヤー（ホスト）がゲームの進行を管理します。

### 操作方法

手番が来た際の操作は以下の通りです。

1. **受けるコマ**を選択します。
2. **攻めるコマ**を選択します。
3. 以下のいずれかの操作で決定します。
   - 画面上の**受けて攻める**（または「攻める」）ボタンを押す
   - 選択した攻めるコマを**ダブルクリック**する

## パスする場合

**パス**ボタンを押してください。

## ルールについて

「ごいた」の詳しいルールや遊び方については、以下のサイトなどを参考にしてください。

- [日本ごいた協会](http://goita.jp/)
- [ごいた - Wikipedia](https://ja.wikipedia.org/wiki/%E3%81%94%E3%81%84%E3%81%9F)

---

## ChangeLog

### 25/12/14 -

## Ver 0.85 (「五し」手動化とバグ修正、プレビュー版)

- **「五し」ルールの改善**:
  - 手札に「五し」がある場合、手動で宣言するかを選択できるようになりました。
  - 宣言された場合、相方が「配り直し」か「続行」かを判断・選択できるようになりました（ホスト・ゲスト・シングルプレイ対応）。
- **不具合修正**:
  - **ラウンド進行バグ**: ラウンド終了画面の裏でゲームが進行してしまう問題を修正（「次のラウンドへ」ボタンが押せない問題を解消）。
  - **ダブルアップ公開**: 上がった際の伏せカード公開ロジックを修正（古いカードではなく正しい最新のカードが公開されます）。
  - **同期ズレ**: ホスト・ゲスト間のステート同期を強化し、ラウンド移行時の安定性を向上。
- **UI/UX 改善**:
  - **完全日本語化**: ログメッセージ（アクション、パス等）を日本語化し、「Player X」表記を「あなた」「CPU X」等の名前に変更。
  - **表示の簡潔化**: チームスコア等の括弧書きを削除し、見やすく改善。
  - **ログ表示時間**: 短いログの表示時間を延長し、読み取りやすくしました。
- **その他**:
  - プレイヤー名の「(あなた)」重複表示バグを修正。

### 25/12/08 -

## Ver 0.8β (マルチプレイ安定化と UX 改善)

- **マルチプレイの大幅改善**:
  - ゲーム開始の問題を修正（ホストが開始ボタンを押してもゲームが始まらない問題を解決）
  - 次ラウンド進行の修正（盤面リセットと手札再配布が正しく動作するように修正）
  - ホスト・ゲスト間のアクション同期を実装
  - ネットワークコードの重複削除と最適化
- **UI/UX 改善**:
  - タイトル画面にバージョン番号を表示（右下）
  - 「ごいたとは？」（Wikipedia）と「ルールページ」（PDF）へのリンクを追加
  - ゲーム画面のレイアウト調整
- **ドキュメント整備**:

  - README 更新
  - 実装済み機能とルールの一覧ドキュメント作成
  - MIT LICENSE の追加

  ## Ver 0.6 (UI 改善とバグ修正)

- **王ルールの修正**: 場に出ている王もカウント対象とし、手札に王が 1 枚でも攻められるように修正
- **視認性の向上**: 2 枚ある王のうち 1 枚を「玉」として表示（ルールは同じ）
- **ダブルアップ修正**: 攻め（リード）でペアを出して上がった際、伏せカードを公開し、得点を正しく倍増するように修正
- **UI 改善**:

  - 設定メニューの追加（ルーム ID 確認、ネットワークログ切替）
  - ルーム ID のコピー＆ペースト機能を追加
  - ネットワークログをデフォルトで非表示に変更
  - タイトルを「May be ごいた Online」に変更

  ## Ver:0.4 (マルチプレイ対応)

- **オンライン対戦の実装**: 離れた友達と遊べるようになりました。
- **ロビー機能**: 部屋の作成、参加、待機ができるロビー画面を追加
- **同期システムの強化**:
  - 手番や出したカードがリアルタイムで同期されます。
  - ラウンド終了時、全員の準備が整うまで次のラウンドが始まらない「待機機能」を実装しました。
- **UI の改善**:
  - 「誰の番か」「何で攻められているか」がひと目で分かるようになりました。

### 25/12/05 -

## Ver:0.2 (基本プレイ可能)

- **基本プレイ可能**: シングルプレイが可能になりました。

---

## 使用技術

- フロントエンド: HTML, CSS, JavaScript (Vanilla)
- ビルドツール: Vite
- バックエンド (通信): Firebase Realtime Database
- 開発支援: Antigravity (Google DeepMind)

## 開発について

本プロジェクトは、能登の伝統的なゲーム「ごいた」を AntiGravity に作らせられるんじゃね？ という軽いノリで作成されました。

## ライセンス

本プロジェクトは [MIT License](LICENSE) のもとで公開されています。
Copyright (c) 2025 [Kafk-A-noob]
